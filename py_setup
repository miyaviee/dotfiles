#!/bin/bash

for ver in 2 3; do
  PIP=$(which pip${ver} || which pip)
  ${PIP} freeze | xargs ${PIP} uninstall -y
  ${PIP} install -IU pip
  ${PIP} install -IU -r requirements.txt
  [ ${ver} -eq 3 ] && ${PIP} install -IU poetry pipdeptree

  DIR=neovim${ver}
  PYTHON=$(which python${ver} || which python)
  rm -rf ~/${DIR} && ${PYTHON} -m virtualenv ~/${DIR}
  source ~/${DIR}/bin/activate
  pip install -IU pynvim
  deactivate
done
